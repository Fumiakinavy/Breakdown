# Views/TaskGraphView.swift ナラティブ

## 2025-10-22T14:24:04Z 事前計画
### 概要
グラフエディタUIをSwiftUIで実装し、ノードの表示・ドラッグ移動・編集・追加を可能にする。
### 目的
LLMが事前生成したサブタスクをマインドマップ風に編集する体験を提供する。
### 最適な実装方法
`Canvas`でエッジ描画、`GraphNodeView`でノード表示を行い、`DragGesture`/`LongPressGesture`/`TapGesture`で操作を割り当てる。
### 最適と思われる理由
SwiftUI純正コンポーネントで構成することで、iOS 17以降における描画性能とアクセシビリティを確保できる。
### 入出力
入力: ビュー・モデルとタスクID。  
出力: ノード編集イベント（位置・タイトル・追加・Undo/Redo）。

## 2025-10-22T14:24:04Z 実装後記録
### 概要
`TaskGraphView`を追加し、ノード描画、ドラッグ移動、長押しでのサブタスク生成、ダブルタップによるタイトル編集、Undo/Redoツールバーを実装した。
### 目的
仕様で求められていたグラフ編集UIをアプリ上で体験できるようにする。
### 最適な実装方法
Canvasでベジェ曲線エッジを描画し、ノード位置は正規化座標で保持してビュー・モデルから更新。Undo/Redoはローカル履歴を活用。
### 最適と思われる理由
ローカル状態のみでレスポンス良く操作でき、将来バックエンド同期とマージしやすい。
### 入出力
入力: ユーザー操作（ドラッグ、長押し、ダブルタップ）。  
出力: グラフ履歴更新、ノードレイアウト更新。
### 実装の評価
要件通りの操作が可能になり、今後のAI差分表示にも拡張しやすい。評価: 95/100。
